Load data...
Generate deepwalk embeddings as input X...
Preprocessing grpah for node2vec... p= 1  q= 1
Preprocessing grpah for node2vec... p= 1  q= 1
Finished in 31.8994 s!
Performing federated learning...

Federated local learning...

Epoch: 000, intra_loss: 4.92442989, inter_loss: 1.00408101, loss_train: 5.92851067, precision_10: 0.02122905
Epoch: 100, intra_loss: 1.57750702, inter_loss: 0.13344695, loss_train: 1.71095395, precision_10: 0.56871508
Epoch: 200, intra_loss: 1.54649138, inter_loss: 0.05863053, loss_train: 1.60512197, precision_10: 0.61452514
Epoch: 300, intra_loss: 1.53169692, inter_loss: 0.03634127, loss_train: 1.56803823, precision_10: 0.62905028
Epoch: 400, intra_loss: 1.50801611, inter_loss: 0.02594994, loss_train: 1.53396606, precision_10: 0.64022346
Epoch: 500, intra_loss: 1.50302446, inter_loss: 0.02041529, loss_train: 1.52343976, precision_10: 0.63798883
Epoch: 600, intra_loss: 1.49407768, inter_loss: 0.01681054, loss_train: 1.51088822, precision_10: 0.64469274
Epoch: 700, intra_loss: 1.49014652, inter_loss: 0.01433973, loss_train: 1.50448620, precision_10: 0.64357542
Epoch: 800, intra_loss: 1.49515176, inter_loss: 0.01292299, loss_train: 1.50807476, precision_10: 0.63798883
Epoch: 900, intra_loss: 1.49236798, inter_loss: 0.01154682, loss_train: 1.50391483, precision_10: 0.64245810
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.48463011, inter_loss: 0.01066658, loss_train: 1.49529672, precision_10: 0.64134078
Epoch: 100, intra_loss: 1.47050071, inter_loss: 0.00995871, loss_train: 1.48045945, precision_10: 0.65363128
Epoch: 200, intra_loss: 1.48266792, inter_loss: 0.00946159, loss_train: 1.49212956, precision_10: 0.64357542
Epoch: 300, intra_loss: 1.47442412, inter_loss: 0.00914820, loss_train: 1.48357236, precision_10: 0.64916201
Epoch: 400, intra_loss: 1.47963738, inter_loss: 0.00852354, loss_train: 1.48816097, precision_10: 0.64469274
Epoch: 500, intra_loss: 1.48214817, inter_loss: 0.00808003, loss_train: 1.49022818, precision_10: 0.64357542
Epoch: 600, intra_loss: 1.47561395, inter_loss: 0.00793801, loss_train: 1.48355198, precision_10: 0.64692737
Epoch: 700, intra_loss: 1.46870649, inter_loss: 0.00766016, loss_train: 1.47636664, precision_10: 0.64134078
Epoch: 800, intra_loss: 1.46337152, inter_loss: 0.00743005, loss_train: 1.47080159, precision_10: 0.64804469
Epoch: 900, intra_loss: 1.47018385, inter_loss: 0.00714185, loss_train: 1.47732568, precision_10: 0.64916201
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.45640159, inter_loss: 0.00697813, loss_train: 1.46337974, precision_10: 0.65139665
Epoch: 100, intra_loss: 1.47491860, inter_loss: 0.00635830, loss_train: 1.48127687, precision_10: 0.65251397
Epoch: 200, intra_loss: 1.47492027, inter_loss: 0.00651157, loss_train: 1.48143184, precision_10: 0.65363128
Epoch: 300, intra_loss: 1.44933295, inter_loss: 0.00637009, loss_train: 1.45570302, precision_10: 0.65474860
Epoch: 400, intra_loss: 1.45969796, inter_loss: 0.00648807, loss_train: 1.46618605, precision_10: 0.65698324
Epoch: 500, intra_loss: 1.45860386, inter_loss: 0.00609673, loss_train: 1.46470058, precision_10: 0.65698324
Epoch: 600, intra_loss: 1.45429420, inter_loss: 0.00605498, loss_train: 1.46034920, precision_10: 0.65363128
Epoch: 700, intra_loss: 1.46491218, inter_loss: 0.00595589, loss_train: 1.47086811, precision_10: 0.66368715
Epoch: 800, intra_loss: 1.45852113, inter_loss: 0.00587639, loss_train: 1.46439755, precision_10: 0.65139665
Epoch: 900, intra_loss: 1.44807673, inter_loss: 0.00575980, loss_train: 1.45383656, precision_10: 0.65139665
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.45488095, inter_loss: 0.00570705, loss_train: 1.46058798, precision_10: 0.65474860
Epoch: 100, intra_loss: 1.46082282, inter_loss: 0.00524083, loss_train: 1.46606362, precision_10: 0.66033520
Epoch: 200, intra_loss: 1.45905721, inter_loss: 0.00559656, loss_train: 1.46465373, precision_10: 0.65586592
Epoch: 300, intra_loss: 1.46147609, inter_loss: 0.00545962, loss_train: 1.46693575, precision_10: 0.65363128
Epoch: 400, intra_loss: 1.46221650, inter_loss: 0.00548084, loss_train: 1.46769738, precision_10: 0.65474860
Epoch: 500, intra_loss: 1.44981849, inter_loss: 0.00528230, loss_train: 1.45510077, precision_10: 0.64916201
Epoch: 600, intra_loss: 1.45100951, inter_loss: 0.00547809, loss_train: 1.45648766, precision_10: 0.65027933
Epoch: 700, intra_loss: 1.45095253, inter_loss: 0.00529127, loss_train: 1.45624375, precision_10: 0.64916201
Epoch: 800, intra_loss: 1.45907140, inter_loss: 0.00546881, loss_train: 1.46454024, precision_10: 0.64692737
Epoch: 900, intra_loss: 1.45845771, inter_loss: 0.00537368, loss_train: 1.46383142, precision_10: 0.64804469
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.45608664, inter_loss: 0.00520193, loss_train: 1.46128857, precision_10: 0.65586592
Epoch: 100, intra_loss: 1.44959044, inter_loss: 0.00491681, loss_train: 1.45450723, precision_10: 0.65027933
Epoch: 200, intra_loss: 1.46029186, inter_loss: 0.00499562, loss_train: 1.46528745, precision_10: 0.64581006
Epoch: 300, intra_loss: 1.45508146, inter_loss: 0.00527065, loss_train: 1.46035206, precision_10: 0.65027933
Epoch: 400, intra_loss: 1.44919419, inter_loss: 0.00492494, loss_train: 1.45411909, precision_10: 0.64916201
Epoch: 500, intra_loss: 1.44791234, inter_loss: 0.00496786, loss_train: 1.45288014, precision_10: 0.65251397
Epoch: 600, intra_loss: 1.45676172, inter_loss: 0.00501233, loss_train: 1.46177399, precision_10: 0.64692737
Epoch: 700, intra_loss: 1.45234227, inter_loss: 0.00482282, loss_train: 1.45716512, precision_10: 0.64581006
Epoch: 800, intra_loss: 1.45405006, inter_loss: 0.00501079, loss_train: 1.45906091, precision_10: 0.64804469
Epoch: 900, intra_loss: 1.44662833, inter_loss: 0.00486090, loss_train: 1.45148921, precision_10: 0.65474860
Federated local learning has been done...

Finished federated learning!

True matched nodes: 213
Total test nodes: 895
Acc: 0.2380
MRR: 0.3775
AUC: 0.9412
Hit: 0.9413
Precision@1: 0.2458
Precision@5: 0.5408
Precision@10: 0.6525
Precision@15: 0.7128
Precision@20: 0.7453
Precision@25: 0.7743
Precision@30: 0.7922
Total runtime: 151.8199 s

CCNE with Federated Learning
Namespace(alpha=1.0, dim=128, epochs=1000, gt_path='data/douban/anchor/node,split=0.2.test.dict', lamda=1, lr=0.001, margin=0.9, neg=1, out_path='data/douban/embeddings', rounds=5, s_edge='data/douban/online/raw/edgelist', t_edge='data/douban/offline/raw/edgelist', train_path='data/douban/anchor/node,split=0.2.train.dict')
Average results:
Acc: 0.2380
MRR: 0.3775
AUC: 0.9412
Hit: 0.9413
Precision@1: 0.2458
Precision@5: 0.5408
Precision@10: 0.6525
Precision@15: 0.7128
Precision@20: 0.7453
Precision@25: 0.7743
Precision@30: 0.7922
time: 151.8199

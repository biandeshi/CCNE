Load data...
Generate deepwalk embeddings as input X...
Preprocessing grpah for node2vec... p= 1  q= 1
Preprocessing grpah for node2vec... p= 1  q= 1
Finished in 67.5114 s!
Performing federated learning...

Federated local learning...

Epoch: 000, intra_loss: 3.25880098, inter_loss: 1.02385402, loss_train: 4.28265476, precision_10: 0.00245298
Epoch: 100, intra_loss: 1.81892347, inter_loss: 0.20668283, loss_train: 2.02560639, precision_10: 0.07849550
Epoch: 200, intra_loss: 1.74903023, inter_loss: 0.09409497, loss_train: 1.84312522, precision_10: 0.09198692
Epoch: 300, intra_loss: 1.71694028, inter_loss: 0.06075909, loss_train: 1.77769935, precision_10: 0.10098119
Epoch: 400, intra_loss: 1.69204092, inter_loss: 0.04695559, loss_train: 1.73899651, precision_10: 0.10711365
Epoch: 500, intra_loss: 1.67237997, inter_loss: 0.03899680, loss_train: 1.71137679, precision_10: 0.11406378
Epoch: 600, intra_loss: 1.66325378, inter_loss: 0.03452632, loss_train: 1.69778013, precision_10: 0.12183156
Epoch: 700, intra_loss: 1.64243150, inter_loss: 0.03096206, loss_train: 1.67339361, precision_10: 0.12469338
Epoch: 800, intra_loss: 1.63606238, inter_loss: 0.02874383, loss_train: 1.66480625, precision_10: 0.12755519
Epoch: 900, intra_loss: 1.62776959, inter_loss: 0.02640298, loss_train: 1.65417254, precision_10: 0.13246116
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.62202621, inter_loss: 0.02477259, loss_train: 1.64679885, precision_10: 0.13736713
Epoch: 100, intra_loss: 1.62864912, inter_loss: 0.02336873, loss_train: 1.65201783, precision_10: 0.14186427
Epoch: 200, intra_loss: 1.60949254, inter_loss: 0.02222874, loss_train: 1.63172126, precision_10: 0.14145544
Epoch: 300, intra_loss: 1.61041594, inter_loss: 0.02159245, loss_train: 1.63200843, precision_10: 0.14145544
Epoch: 400, intra_loss: 1.59812212, inter_loss: 0.02038879, loss_train: 1.61851096, precision_10: 0.14145544
Epoch: 500, intra_loss: 1.60272408, inter_loss: 0.01968634, loss_train: 1.62241042, precision_10: 0.14431725
Epoch: 600, intra_loss: 1.59755445, inter_loss: 0.01860969, loss_train: 1.61616409, precision_10: 0.14922322
Epoch: 700, intra_loss: 1.59418082, inter_loss: 0.01803197, loss_train: 1.61221278, precision_10: 0.14799673
Epoch: 800, intra_loss: 1.58426440, inter_loss: 0.01759388, loss_train: 1.60185826, precision_10: 0.15126738
Epoch: 900, intra_loss: 1.58196211, inter_loss: 0.01658933, loss_train: 1.59855139, precision_10: 0.15167621
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.58018506, inter_loss: 0.01615748, loss_train: 1.59634256, precision_10: 0.15167621
Epoch: 100, intra_loss: 1.57696152, inter_loss: 0.01521437, loss_train: 1.59217584, precision_10: 0.15208504
Epoch: 200, intra_loss: 1.57886195, inter_loss: 0.01516225, loss_train: 1.59402418, precision_10: 0.15167621
Epoch: 300, intra_loss: 1.57512736, inter_loss: 0.01493396, loss_train: 1.59006131, precision_10: 0.15085854
Epoch: 400, intra_loss: 1.57364666, inter_loss: 0.01482264, loss_train: 1.58846927, precision_10: 0.15290270
Epoch: 500, intra_loss: 1.57610381, inter_loss: 0.01448576, loss_train: 1.59058952, precision_10: 0.15249387
Epoch: 600, intra_loss: 1.56875813, inter_loss: 0.01440914, loss_train: 1.58316731, precision_10: 0.15372036
Epoch: 700, intra_loss: 1.57368839, inter_loss: 0.01397877, loss_train: 1.58766711, precision_10: 0.15453802
Epoch: 800, intra_loss: 1.56636071, inter_loss: 0.01382780, loss_train: 1.58018851, precision_10: 0.15576451
Epoch: 900, intra_loss: 1.57074821, inter_loss: 0.01338907, loss_train: 1.58413732, precision_10: 0.15780867
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.57089353, inter_loss: 0.01318222, loss_train: 1.58407581, precision_10: 0.15699101
Epoch: 100, intra_loss: 1.56381428, inter_loss: 0.01263495, loss_train: 1.57644928, precision_10: 0.15453802
Epoch: 200, intra_loss: 1.56353903, inter_loss: 0.01265425, loss_train: 1.57619333, precision_10: 0.15494685
Epoch: 300, intra_loss: 1.56761575, inter_loss: 0.01253938, loss_train: 1.58015513, precision_10: 0.15453802
Epoch: 400, intra_loss: 1.56261683, inter_loss: 0.01233012, loss_train: 1.57494700, precision_10: 0.15699101
Epoch: 500, intra_loss: 1.56385350, inter_loss: 0.01212542, loss_train: 1.57597888, precision_10: 0.15126738
Epoch: 600, intra_loss: 1.55927598, inter_loss: 0.01219620, loss_train: 1.57147217, precision_10: 0.15372036
Epoch: 700, intra_loss: 1.56339383, inter_loss: 0.01192438, loss_train: 1.57531822, precision_10: 0.15494685
Epoch: 800, intra_loss: 1.55713105, inter_loss: 0.01169419, loss_train: 1.56882524, precision_10: 0.15412919
Epoch: 900, intra_loss: 1.55029893, inter_loss: 0.01157410, loss_train: 1.56187308, precision_10: 0.15617334
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.55806541, inter_loss: 0.01145375, loss_train: 1.56951916, precision_10: 0.15658217
Epoch: 100, intra_loss: 1.55918860, inter_loss: 0.01067397, loss_train: 1.56986260, precision_10: 0.15658217
Epoch: 200, intra_loss: 1.55388117, inter_loss: 0.01067217, loss_train: 1.56455338, precision_10: 0.15739984
Epoch: 300, intra_loss: 1.55710340, inter_loss: 0.01065709, loss_train: 1.56776047, precision_10: 0.15494685
Epoch: 400, intra_loss: 1.55632687, inter_loss: 0.01069900, loss_train: 1.56702590, precision_10: 0.15494685
Epoch: 500, intra_loss: 1.55373204, inter_loss: 0.01044499, loss_train: 1.56417704, precision_10: 0.15412919
Epoch: 600, intra_loss: 1.54654860, inter_loss: 0.01060921, loss_train: 1.55715787, precision_10: 0.15699101
Epoch: 700, intra_loss: 1.55046654, inter_loss: 0.01032157, loss_train: 1.56078815, precision_10: 0.15249387
Epoch: 800, intra_loss: 1.55401754, inter_loss: 0.01046947, loss_train: 1.56448698, precision_10: 0.15372036
Epoch: 900, intra_loss: 1.54786623, inter_loss: 0.01023614, loss_train: 1.55810237, precision_10: 0.15535568
Federated local learning has been done...

Finished federated learning!

True matched nodes: 105
Total test nodes: 2446
Acc: 0.0429
MRR: 0.0663
AUC: 0.7992
Hit: 0.7992
Precision@1: 0.0192
Precision@5: 0.1067
Precision@10: 0.1537
Precision@15: 0.1913
Precision@20: 0.2236
Precision@25: 0.2465
Precision@30: 0.2621
Total runtime: 457.7663 s

CCNE with Federated Learning
Namespace(alpha=1.0, dim=128, epochs=1000, gt_path='data/twitter1_youtube/anchor/node,split=0.2.test.dict', lamda=1, lr=0.001, margin=0.9, neg=1, out_path='data/twitter1_youtube/embeddings', rounds=5, s_edge='data/twitter1_youtube/twitter1/raw/edgelist', t_edge='data/twitter1_youtube/youtube/raw/edgelist', train_path='data/twitter1_youtube/anchor/node,split=0.2.train.dict')
Average results:
Acc: 0.0429
MRR: 0.0663
AUC: 0.7992
Hit: 0.7992
Precision@1: 0.0192
Precision@5: 0.1067
Precision@10: 0.1537
Precision@15: 0.1913
Precision@20: 0.2236
Precision@25: 0.2465
Precision@30: 0.2621
time: 457.7663

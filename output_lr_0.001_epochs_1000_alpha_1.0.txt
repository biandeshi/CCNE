Load data...
Generate deepwalk embeddings as input X...
Preprocessing grpah for node2vec... p= 1  q= 1
Preprocessing grpah for node2vec... p= 1  q= 1
Finished in 29.3449 s!
Performing federated learning...

Federated local learning...

Epoch: 000, intra_loss: 5.29580307, inter_loss: 0.34421992, loss_train: 5.64002323, precision_10: 0.00558659
Epoch: 100, intra_loss: 1.55945134, inter_loss: 0.11403347, loss_train: 1.67348480, precision_10: 0.46592179
Epoch: 200, intra_loss: 1.53083909, inter_loss: 0.05973900, loss_train: 1.59057808, precision_10: 0.58435754
Epoch: 300, intra_loss: 1.51294208, inter_loss: 0.04111299, loss_train: 1.55405509, precision_10: 0.61452514
Epoch: 400, intra_loss: 1.50109291, inter_loss: 0.03158595, loss_train: 1.53267884, precision_10: 0.63575419
Epoch: 500, intra_loss: 1.49477732, inter_loss: 0.02552620, loss_train: 1.52030349, precision_10: 0.64245810
Epoch: 600, intra_loss: 1.48935270, inter_loss: 0.02188187, loss_train: 1.51123452, precision_10: 0.65698324
Epoch: 700, intra_loss: 1.48492599, inter_loss: 0.01917863, loss_train: 1.50410461, precision_10: 0.65251397
Epoch: 800, intra_loss: 1.47798347, inter_loss: 0.01701870, loss_train: 1.49500215, precision_10: 0.65810056
Epoch: 900, intra_loss: 1.47729111, inter_loss: 0.01540072, loss_train: 1.49269187, precision_10: 0.66368715
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.47220421, inter_loss: 0.01412921, loss_train: 1.48633337, precision_10: 0.65363128
Epoch: 100, intra_loss: 1.46855640, inter_loss: 0.01337370, loss_train: 1.48193014, precision_10: 0.66033520
Epoch: 200, intra_loss: 1.47389019, inter_loss: 0.01267922, loss_train: 1.48656940, precision_10: 0.66592179
Epoch: 300, intra_loss: 1.46828878, inter_loss: 0.01208821, loss_train: 1.48037696, precision_10: 0.66145251
Epoch: 400, intra_loss: 1.46971297, inter_loss: 0.01110382, loss_train: 1.48081684, precision_10: 0.66368715
Epoch: 500, intra_loss: 1.48307109, inter_loss: 0.01064009, loss_train: 1.49371123, precision_10: 0.66256983
Epoch: 600, intra_loss: 1.47765219, inter_loss: 0.01016643, loss_train: 1.48781860, precision_10: 0.66256983
Epoch: 700, intra_loss: 1.46759081, inter_loss: 0.00972513, loss_train: 1.47731590, precision_10: 0.66368715
Epoch: 800, intra_loss: 1.46658468, inter_loss: 0.00941826, loss_train: 1.47600293, precision_10: 0.67262570
Epoch: 900, intra_loss: 1.45625496, inter_loss: 0.00909026, loss_train: 1.46534526, precision_10: 0.67486034
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.46182954, inter_loss: 0.00866876, loss_train: 1.47049832, precision_10: 0.66927374
Epoch: 100, intra_loss: 1.46823061, inter_loss: 0.00839676, loss_train: 1.47662735, precision_10: 0.66703911
Epoch: 200, intra_loss: 1.47186160, inter_loss: 0.00814933, loss_train: 1.48001099, precision_10: 0.66592179
Epoch: 300, intra_loss: 1.46277928, inter_loss: 0.00805202, loss_train: 1.47083127, precision_10: 0.66592179
Epoch: 400, intra_loss: 1.45663071, inter_loss: 0.00790843, loss_train: 1.46453917, precision_10: 0.67150838
Epoch: 500, intra_loss: 1.45737910, inter_loss: 0.00753850, loss_train: 1.46491766, precision_10: 0.66480447
Epoch: 600, intra_loss: 1.46334052, inter_loss: 0.00738146, loss_train: 1.47072196, precision_10: 0.67262570
Epoch: 700, intra_loss: 1.45030951, inter_loss: 0.00714610, loss_train: 1.45745564, precision_10: 0.66592179
Epoch: 800, intra_loss: 1.45911717, inter_loss: 0.00718557, loss_train: 1.46630275, precision_10: 0.66033520
Epoch: 900, intra_loss: 1.46078849, inter_loss: 0.00702163, loss_train: 1.46781015, precision_10: 0.66368715
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.45933867, inter_loss: 0.00699999, loss_train: 1.46633863, precision_10: 0.67150838
Epoch: 100, intra_loss: 1.45132506, inter_loss: 0.00677216, loss_train: 1.45809722, precision_10: 0.66145251
Epoch: 200, intra_loss: 1.44626951, inter_loss: 0.00667798, loss_train: 1.45294750, precision_10: 0.66033520
Epoch: 300, intra_loss: 1.45294833, inter_loss: 0.00662685, loss_train: 1.45957518, precision_10: 0.65698324
Epoch: 400, intra_loss: 1.44500959, inter_loss: 0.00638807, loss_train: 1.45139766, precision_10: 0.65921788
Epoch: 500, intra_loss: 1.45189083, inter_loss: 0.00632721, loss_train: 1.45821810, precision_10: 0.65698324
Epoch: 600, intra_loss: 1.45227683, inter_loss: 0.00616948, loss_train: 1.45844626, precision_10: 0.65139665
Epoch: 700, intra_loss: 1.45381737, inter_loss: 0.00641993, loss_train: 1.46023726, precision_10: 0.64916201
Epoch: 800, intra_loss: 1.45116651, inter_loss: 0.00623717, loss_train: 1.45740366, precision_10: 0.65474860
Epoch: 900, intra_loss: 1.45589685, inter_loss: 0.00603217, loss_train: 1.46192908, precision_10: 0.65139665
Federated local learning has been done...

Federated local learning...

Epoch: 000, intra_loss: 1.44167209, inter_loss: 0.00586712, loss_train: 1.44753921, precision_10: 0.65139665
Epoch: 100, intra_loss: 1.43952441, inter_loss: 0.00576280, loss_train: 1.44528723, precision_10: 0.65698324
Epoch: 200, intra_loss: 1.45754242, inter_loss: 0.00576887, loss_train: 1.46331131, precision_10: 0.65586592
Epoch: 300, intra_loss: 1.44724059, inter_loss: 0.00591610, loss_train: 1.45315671, precision_10: 0.65698324
Epoch: 400, intra_loss: 1.45476937, inter_loss: 0.00567788, loss_train: 1.46044731, precision_10: 0.64916201
Epoch: 500, intra_loss: 1.45589077, inter_loss: 0.00568953, loss_train: 1.46158028, precision_10: 0.65139665
Epoch: 600, intra_loss: 1.45370305, inter_loss: 0.00567807, loss_train: 1.45938110, precision_10: 0.65251397
Epoch: 700, intra_loss: 1.45694256, inter_loss: 0.00559764, loss_train: 1.46254015, precision_10: 0.65474860
Epoch: 800, intra_loss: 1.44626546, inter_loss: 0.00541128, loss_train: 1.45167673, precision_10: 0.65698324
Epoch: 900, intra_loss: 1.45035112, inter_loss: 0.00550014, loss_train: 1.45585120, precision_10: 0.65363128
Federated local learning has been done...

Finished federated learning!

True matched nodes: 225
Total test nodes: 895
Acc: 0.2514
MRR: 0.3787
AUC: 0.9522
Hit: 0.9522
Precision@1: 0.2346
Precision@5: 0.5542
Precision@10: 0.6525
Precision@15: 0.7073
Precision@20: 0.7441
Precision@25: 0.7765
Precision@30: 0.7955
Total runtime: 148.8844 s

CCNE with Federated Learning
Namespace(alpha=1.0, dim=128, epochs=1000, gt_path='data/douban/anchor/node,split=0.2.test.dict', lamda=1, lr=0.001, margin=0.9, neg=1, out_path='data/douban/embeddings', rounds=5, s_edge='data/douban/online/raw/edgelist', t_edge='data/douban/offline/raw/edgelist', train_path='data/douban/anchor/node,split=0.2.train.dict')
Average results:
Acc: 0.2514
MRR: 0.3787
AUC: 0.9522
Hit: 0.9522
Precision@1: 0.2346
Precision@5: 0.5542
Precision@10: 0.6525
Precision@15: 0.7073
Precision@20: 0.7441
Precision@25: 0.7765
Precision@30: 0.7955
time: 148.8844
